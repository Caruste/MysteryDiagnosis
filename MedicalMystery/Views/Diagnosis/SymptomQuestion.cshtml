@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@

@*
    Reference:  https://www.webslesson.info/2016/02/dynamically-add-remove-input-fields-in-php-with-jquery-ajax.html
*@

<form name="add_symptom" id="add_symptom" style="margin-top: 20px; margin-bottom: 25px;">
    <div class="table-responsive">
        <table class="table table-bordered" id="dynamic_field">
            <tr>
                <td><b class="form-control symptom_list"> First symptom</b></td>
                <td><button type="button" name="yes" id="yes" class="btn btn-success unused">Yes</button></td>
                <td><button type="button" name="no" id="no" class="btn btn-danger unused">No</button></td>
            </tr>
        </table>
        <input type="button" name="submit" id="submit" class="btn btn-info" value="Submit" />
    </div>
</form>
<div class="table-responsive">
    <table id="symptoms" class="table table-bordered">
        <tr>
            <th>Possible diseases</th>
        </tr>
    </table>
</div>


@section Scripts {
    <script>
        $(document).ready(function () {
            $(document).on('click', '.symptom_remove', function () {
                var button_id = $(this).attr("id");
                $('#row' + button_id + '').remove();
            });
            $('#submit').click(function () {

                var lines = [];
                $.each($('#add_symptom').serializeArray(), function (i, v) {
                    if (v.value) lines.push(v.value);
                });
                $.ajax({
                    type: "POST",
                    url: "/api/Test",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(lines),
                    dataType: "json",
                    success: function (data) {
                        $(".symptom").remove();
                        $.each(data, function (i, v) {
                            $('#symptoms').append('<p class="symptom">' + v.name + '</p>');
                        });
                    }
                });
            });
        });
        $(document).on('click', '.unused', function () {
            alert("hi");
            $('.unused').removeClass('unused').addClass('used');
            $('#dynamic_field').append('<tr><td><b class="form-control symptom_list"> First symptom</b></td><td><button type="button" name="yes" id="yes" class="btn btn-success unused">Yes</button></td><td><button type="button" name="no" id="no" class="btn btn-danger unused">No</button></td></tr>');
        });

        function checkSymptoms() {
            // check symptoms with API by passing through symptoms
            window.alert($('#symptoms').val())
        }
    </script>
}
